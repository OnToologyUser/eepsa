PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX eepsa: <https://w3id.org/eepsa#>
PREFIX f4eepsa: <https://w3id.org/f4eepsa#>
PREFIX pep: <https://w3id.org/pep/>
PREFIX qudt: <http://qudt.org/schema/qudt#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

CONSTRUCT {?hvacControlStrategy eepsa:isForecastedToProduceSituation eepsa:INSHTForSedentarySituation}
FROM <myGraph>
WHERE
{
?prediction rdf:type f4eepsa:TemperatureForecast.
?prediction pep:usedProcedure ?predictiveProcedure.
?predictiveProcedure pep:hasInput ?hvacControlStrategy.
	{
	SELECT (COUNT(?predResult) AS ?count), ?prediction
		FROM <myGraph>
		WHERE{
		?prediction pep:hasResult ?predResult.
		?predResult qudt:numericValue ?temperatureVal.
		?predResult f4eepsa:hasForecastTime ?time.
		FILTER(
			xsd:double(?temperatureVal) >= 17 &&
			xsd:double(?temperatureVal) <= 27 &&
			xsd:time(?time) >= xsd:time(08:00) &&
			xsd:time(?time) <= xsd:time(17:00) 
		)
		}
	}
	FILTER (?count= 10)
}
GROUP BY ?prediction 
